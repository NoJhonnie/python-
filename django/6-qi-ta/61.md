[课程介绍](../index.html)

* [**1.**入门](../part1/1.html)
  * [**1.1.**搭建开发环境](../part1/2.html)
  * [**1.2.**设计模型](../part1/3.html)
  * [**1.3.**管理站点](../part1/4.html)
  * [**1.4.**视图](../part1/5.html)
  * [**1.5.**模板](../part1/6.html)
  * [**1.6.**总结与作业](../part1/7.html)
* [**2.**模型](../part2/1.html)
  * [**2.1.**定义模型](../part2/2.html)
  * [**2.2.**模型成员](../part2/3.html)
  * [**2.3.**模型查询](../part2/4.html)
  * [**2.4.**自连接](../part2/5.html)
  * [**2.5.**总结与作业](../part2/6.html)
* [**3.**视图](../part3/1.html)
  * [**3.1.**URLconf](../part3/2.html)
  * [**3.2.**视图函数](../part3/3.html)
  * [**3.3.**Request对象](../part3/4.html)
    * [**3.3.1.**QueryDict对象](../part3/4_1.html)
    * [**3.3.2.**GET属性](../part3/4_2.html)
    * [**3.3.3.**POST属性](../part3/4_3.html)
  * [**3.4.**Response对象](../part3/5.html)
  * [**3.5.**状态保持](../part3/6.html)
  * [**3.6.**总结与作业](../part3/7.html)
* [**4.**模板](../part4/1.html)
  * [**4.1.**定义模板](../part4/2.html)
  * [**4.2.**模板继承](../part4/3.html)
  * [**4.3.**HTML转义](../part4/4.html)
  * [**4.4.**CSRF](../part4/5.html)
  * [**4.5.**验证码](../part4/6.html)
  * [**4.6.**总结与作业](../part4/7.html)
* [**5.**高级](../part5/1.html)
  * [**5.1.**静态文件处理](../part5/2.html)
  * [**5.2.**中间件](../part5/3.html)
  * [**5.3.**上传图片](../part5/4.html)
  * [**5.4.**Admin站点](../part5/5.html)
  * [**5.5.**分页](../part5/6.html)
  * [**5.6.**ajax](../part5/7.html)
  * [**5.7.**总结与作业](../part5/8.html)
* [**6.**第三方](../part6/1.html)
  * [**6.1.**富文本编辑器](../part6/2.html)
  * [**6.2.**缓存](../part6/3.html)
  * [**6.3.**全文检索](../part6/4.html)
  * [**6.4.**celery](../part6/5.html)
  * [**6.5.**布署](../part6/6.html)
  * [**6.6.**总结与作业](../part6/7.html)
* [**7.**Git与项目](../part7/1.html)
  * [**7.1.**Git简介](../part7/2.html)
    * [**7.1.1.**远程仓库](../part7/2_2.html)
    * [**7.1.2.**本地仓库](../part7/2_1.html)
  * [**7.2.**项目设计](../part7/3.html)
  * [**7.3.**模型类设计](../part7/4.html)
  * [**7.4.**使用页面](../part7/5.html)
  * [**7.5.**总结与作业](../part7/6.html)
* 
* [Published with GitBook](https://www.gitbook.com)













# 富文本编辑器 {#富文本编辑器}

* 借助富文本编辑器，管理员能够编辑出来一个包含html的页面，从而页面的显示效果，可以由管理员定义，而不用完全依赖于前期开发人员
* 此处以tinymce为例，其它富文本编辑器的使用可以自行学习
* 使用编辑器的显示效果为：![](/assets/editor.png)

#### 下载安装 {#下载安装}

* 在网站
  [pypi网站](https://pypi.python.org/pypi)
  搜索并下载"django-tinymce-2.4.0"
* 解压

```
tar zxvf django-tinymce-2.4.0.tar.gz
```

* 进入解压后的目录，工作在虚拟环境，安装

```
python setup.py install
```

#### 应用到项目中 {#应用到项目中}

* 在settings.py中为INSTALLED\_APPS添加编辑器应用

```
INSTALLED_APPS = (
    ...
    'tinymce',
)
```

* 在settings.py中添加编辑配置项

```
TINYMCE_DEFAULT_CONFIG = {
    'theme': 'advanced',
    'width': 600,
    'height': 400,
}
```

* 在根urls.py中配置

```
urlpatterns = [
    ...
    url(r'^tinymce/', include('tinymce.urls')),
]
```

* 在应用中定义模型的属性

```
from django.db import models
from tinymce.models import HTMLField

class HeroInfo(models.Model):
    ...
    hcontent = HTMLField()
```

* 在后台管理界面中，就会显示为富文本编辑器，而不是多行文本框

#### 自定义使用 {#自定义使用}

* 定义视图editor，用于显示编辑器并完成提交

```
def editor(request):
    return render(request, 'other/editor.html')
```

* 配置url

```
urlpatterns = [
    ...
    url(r'^editor/$', views.editor, name='editor'),
]
```

* 创建模板editor.html

```
<!DOCTYPE html>
<html>
<head>
<title>
</title>
<script type="text/javascript" src='/static/tiny_mce/tiny_mce.js'>
</script>
<script type="text/javascript">

        tinyMCE.init({
            'mode':'textareas',
            'theme':'advanced',
            'width':400,
            'height':100
        });
    
</script>
</head>
<body>
<form method="post" action="/content/">
<input type="text" name="hname">
<br>
<textarea name='hcontent'>
哈哈，这是啥呀
</textarea>
<br>
<input type="submit" value="提交">
</form>
</body>
</html>
```

* 定义视图content，接收请求，并更新heroinfo对象

```
def content(request):
    hname = request.POST['hname']
    hcontent = request.POST['hcontent']

    heroinfo = HeroInfo.objects.get(pk=1)
    heroinfo.hname = hname
    heroinfo.hcontent = hcontent
    heroinfo.save()

    return render(request, 'other/content.html', {'hero': heroinfo})
```

* 添加url项

```
urlpatterns = [
    ...
    url(r'^content/$', views.content, name='content'),
]

```

* 定义模板content.html

```
<!DOCTYPE html>
<html>
<head>
<title>
</title>
</head>
<body>

姓名：{{hero.hname}}

<hr>

{%autoescape off%}
{{hero.hcontent}}
{%endautoescape%}

</body>
</html>
```



  


